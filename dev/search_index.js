var documenterSearchIndex = {"docs":
[{"location":"","page":"Home","title":"Home","text":"CurrentModule = HydrologyPlanetesimals","category":"page"},{"location":"#HydrologyPlanetesimals","page":"Home","title":"HydrologyPlanetesimals","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Documentation for HydrologyPlanetesimals.","category":"page"},{"location":"","page":"Home","title":"Home","text":"","category":"page"},{"location":"","page":"Home","title":"Home","text":"Modules = [HydrologyPlanetesimals]","category":"page"},{"location":"#HydrologyPlanetesimals.Q_radiogenic-NTuple{5, Any}","page":"Home","title":"HydrologyPlanetesimals.Q_radiogenic","text":"Compute radiogenic heat production of isotope mixture.\n\nQ_radiogenic(f, ratio, E, tau, time)\n\n\nDetails\n\n- f: fraction of radioactive matter [atoms/kg]\n- ratio: initial ratio of radioactive to non-radioactive isotopes\n- E: heat energy [J]\n- tau: exp decay mean lifetime ``\\tau=\\frac{t_{1/2}}{\\log{2}}`` [s]\n- time: time elapsed since start of radioactive decay [s]\n\nReturns\n\n- Q: radiogenic heat production [W/kg]\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.apply_insulating_boundary_conditions!-Tuple{Any}","page":"Home","title":"HydrologyPlanetesimals.apply_insulating_boundary_conditions!","text":"Apply insulating boundary conditions to given array:\n\n[x x x x x x; x a b c d x; x e f g h x; x x x x x x]\n\nbecomes\n\n[a a b c d d; a a b c d d; e e f g h h; e e f g h h]\n\nDetails\n\n- t: array to apply insulating boundary conditions to\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.apply_subgrid_stress_diffusion!-NTuple{16, Any}","page":"Home","title":"HydrologyPlanetesimals.apply_subgrid_stress_diffusion!","text":"Apply xy (basic grid) and xx (P grid) subgrid stress diffusion to markers.\n\napply_subgrid_stress_diffusion!(xm, ym, tm, inv_gggtotalm, sxxm, sxym, SXX0, SXY0, DSXX, DSXY, SXXSUM, SXYSUM, WTPSUM, WTSUM, dtm, marknum)\n\n\nDetails\n\n- xm: marker x-coordinates\n- ym: marker y-coordinates\n- tm: marker type\n- inv_gggtotalm: inverse of total shear modulus of markers\n- sxxm: marker σ′xx [Pa]\n- sxym: marker σxy [Pa]\n- SXX0: σ₀′xx at P nodes [1/s]\n- SXY0: σ₀xy at basic nodes [1/s]\n- DSXX: stress change Δσ′xx at P nodes\n- DSXY: stress change Δσxy at basic nodes\n- SXXSUM: interpolation of SXX at P nodes\n- SXYSUM: interpolation of SXY at basic nodes\n- WTPSUM: interpolation weights at P nodes\n- WTSUM: interpolation weights at basic nodes\n- dtm: displacement time step\n- marknum: total number of markers in use\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.apply_subgrid_temperature_diffusion!-NTuple{11, Any}","page":"Home","title":"HydrologyPlanetesimals.apply_subgrid_temperature_diffusion!","text":"Apply subgrid temperature diffusion to markers.\n\napply_subgrid_temperature_diffusion!(xm, ym, tm, tkm, phim, tk1, DT, TKSUM, RHOCPSUM, dtm, marknum)\n\n\nDetails\n\n- xm: marker x-coordinates \n- ym: marker y-coordinates\n- tm: marker type\n- tkm: marker temperature\n- phim: marker porosity\n- tk1: current temperature at P nodes\n- DT: temperature change at P nodes\n- TKSUM: interpolation of TK at P nodes \n- RHOCPSUM: interpolation of RHOCP at P nodes\n- dtm: displacement time step\n- marknum: total number of markers in use\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.assemble_hydromechanical_lse!-NTuple{24, Any}","page":"Home","title":"HydrologyPlanetesimals.assemble_hydromechanical_lse!","text":"Assemble hydromechanical system of equations.\n\nassemble_hydromechanical_lse!(ETAcomp, ETAPcomp, SXYcomp, SXXcomp, SYYcomp, dRHOXdx, dRHOXdy, dRHOYdx, dRHOYdy, RHOX, RHOY, RHOFX, RHOFY, RX, RY, ETAPHI, BETTAPHI, PHI, gx, gy, pr0, pf0, dt, R)\n\n\nDetails\n\n- ETAcomp: computational viscosity at basic nodes\n- ETAPcomp: computational viscosity at P nodes\n- SXYcomp: computational previous XY stress at basic nodes\n- SXXcomp: computational previous XX stress at P nodes\n- SYYcomp: computational previous YY stress at P nodes\n- dRHOXdx: total density gradient in x direction at Vx nodes\n- dRHOXdy: total density gradient in y direction at Vx nodes\n- dRHOYdx: total density gradient in x direction at Vy nodes\n- dRHOYdy: total density gradient in y direction at Vy nodes\n- RHOX: total density at Vx nodes\n- RHOY: total density at Vy nodes\n- RHOFX: fluid density at Vx nodes\n- RHOFY: fluid density at Vy nodes\n- RX: ηfluid/Kϕ at Vx nodes\n- RY: ηfluid/Kϕ at Vy nodes\n- ETAPHI: bulk viscosity at P nodes\n- BETTAPHI: bulk compressibility at P nodes\n- PHI: porosity at P nodes\n- gx: x gravitational acceleration at Vx nodes\n- gy: y gravitational acceleration at Vy nodes\n- pr0: previous total pressure at P nodes\n- pf0: previous fluid pressure at P nodes\n- dt: time step\n- R: vector to store RHS coefficients\n\nReturns\n\n- L: LHS coefficient matrix\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.backtrace_pressures_rk4!-NTuple{11, Any}","page":"Home","title":"HydrologyPlanetesimals.backtrace_pressures_rk4!","text":"Backtrack pressure nodes using classic Runge-Kutta integration (RK4)  to update total, solid, and fluid pressure under consideration of  two-phase flow velocities.\n\nbacktrace_pressures_rk4!(pr, pr0, ps, ps0, pf, pf0, vx, vy, vxf, vyf, dtm)\n\n\nDetails\n\n- pr:\n- pr0:\n- ps:\n- ps0:\n- pf:\n- pf0:\n- vx: \n- vy: \n- vxf: \n- vyf:\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.calculate_radioactive_heating-Tuple{Any, Any, Any}","page":"Home","title":"HydrologyPlanetesimals.calculate_radioactive_heating","text":"Compute radiogenic heat production of 26Al and 60Fe isotopes.\n\ncalculate_radioactive_heating(al, fe, timesum)\n\n\nDetails\n\n- al: true if radioactive isotope 26Al is present\n- fe: true if radioactive isotope 60Fe is present\n- timesum: time elapsed since initial conditions at start of simulation\n\nReturns\n\n- hrsolidm: radiogenic heat production of 26Al [W/m^3]\n- hrfluidm: radiogenic heat production of 60Fe [W/m^3]\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.compute_Aϕ!-NTuple{9, Any}","page":"Home","title":"HydrologyPlanetesimals.compute_Aϕ!","text":"Compute porosity coefficient Aϕ = Dln[(1-ϕ)/ϕ]/Dt\n\ncompute_Aϕ!(APHI, ETAPHI, BETTAPHI, PHI, pr, pf, pr0, pf0, dt)\n\n\nDetails\n\nIn\n\n- ETAPHI: bulk viscosity at P Nodes\n- BETTAPHI: bulk compressibility at P nodes\n- PHI: porosity at P Nodes\n- pr: total pressure at P nodes\n- pf: fluid pressure at P nodes\n- pr0: previous step total pressure at P nodes\n- pf0: previous step fluid pressure at P nodes\n- dt: time step\n\nOut\n\n- APHI: porosity coefficient at P nodes\n\nReturns\n\n- aphimax: maximum absolute porosity coefficient\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.compute_adiabatic_heating!-NTuple{11, Any}","page":"Home","title":"HydrologyPlanetesimals.compute_adiabatic_heating!","text":"Compute adiabatic heating based on basic (temperature) and P grids.\n\ncompute_adiabatic_heating!(HA, tk1, ALPHA, ALPHAF, PHI, vx, vy, vxf, vyf, ps, pf)\n\n\nDetails\n\n- HA: adiabatic heating at P nodes\n- tk1: previous temperature at P nodes\n- ALPHA: thermal expansion coefficient at P nodes\n- ALPHAF: fluid thermal expansion coefficient at P nodes\n- PHI: porosity at P nodes\n- vx: solid vx-velocity at Vx nodes\n- vy: solid vy-velocity at Vy nodes\n- vxf: fluid vx-velocity at Vx nodes\n- vyf: fluid vy-velocity at Vy nodes\n- ps: solid pressure at P nodes\n- pf: fluid pressure at P nodes\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.compute_basic_node_properties!-NTuple{16, Any}","page":"Home","title":"HydrologyPlanetesimals.compute_basic_node_properties!","text":"Compute properties of basic nodes based on interpolation arrays.\n\ncompute_basic_node_properties!(ETA0SUM, ETASUM, GGGSUM, SXYSUM, COHSUM, TENSUM, FRISUM, WTSUM, ETA0, ETA, GGG, SXY0, COH, TEN, FRI, YNY)\n\n\nDetails\n\n- ETA0SUM: ETA0 interpolation array\n- ETASUM: ETA interpolation array\n- GGGSUM: GGG interpolation array\n- SXYSUM: SXY interpolation array\n- COHSUM: COH interpolation array\n- TENSUM: TEN interpolation array\n- FRISUM: FRI interpolation array\n- WTSUM: WT interpolation array\n- ETA0: ETA0 basic node array\n- ETA: ETA basic node array\n- GGG: GGG basic node array\n- SXY0: SXY basic node array\n- COH: COH basic node array\n- TEN: TEN basic node array\n- FRI: FRI basic node array\n- YNY: YNY basic node array\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.compute_displacement_timestep-NTuple{8, Any}","page":"Home","title":"HydrologyPlanetesimals.compute_displacement_timestep","text":"Compute displacement time step.\n\ncompute_displacement_timestep(vx, vy, vxf, vyf, dt, dxymax, aphimax, dphimax)\n\n\nDetails\n\n- vx: solid vx velocity at Vx nodes\n- vy: solid vy velocity at Vy nodes\n- vxf: fluid vx velocity at Vx nodes\n- vyf: fluid vy velocity at Vy nodes\n- dt: current time step\n- dxymax: maximum allowed grid spacing movement of markers per time step\n- aphimax: maximum observed porosity coefficient\n- dphimax: maximum allowed porosity ratio change per time step\n\nReturns\n\n- dtm: displacement time step\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.compute_fluid_velocities!-NTuple{8, Any}","page":"Home","title":"HydrologyPlanetesimals.compute_fluid_velocities!","text":"Compute current fluid velocities.\n\ncompute_fluid_velocities!(PHIX, PHIY, qxD, qyD, vx, vy, vxf, vyf)\n\n\nDetails\n\nIn\n\n- PHIX: porosity at Vx nodes\n- PHIY: porosity at Vy nodes\n- qxD: qx-Darcy flux at Vx nodes\n- qyD: qy-Darcy flux at Vy nodes\n- vx: solid velocity at Vx nodes\n- vy: solid velocity at Vy nodes\n\nOut\n\n- vxf: fluid vx velocity at Vx nodes\n- vyf: fluid vy velocity at Vy nodes\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.compute_gravity_solution!-NTuple{6, Any}","page":"Home","title":"HydrologyPlanetesimals.compute_gravity_solution!","text":"Compute gravity solution in P nodes to obtain gravitational accelerations gx for Vx nodes, gy for Vy nodes.\n\ncompute_gravity_solution!(SP, RP, RHO, FI, gx, gy)\n\n\nDetails\n\n- SP: solution vector\n- RP: right hand side vector\n- RHO: density at P nodes\n- FI: gravity potential at P nodes\n- gx: x gravitational acceleration at Vx nodes\n- gy: y gravitational acceleration at Vy nodes\n\nReturns\n\nnothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.compute_marker_properties!-NTuple{15, Any}","page":"Home","title":"HydrologyPlanetesimals.compute_marker_properties!","text":"Compute properties of given marker and save them to corresponding arrays.\n\ncompute_marker_properties!(m, tm, tkm, rhototalm, rhocptotalm, etasolidcur, etafluidcur, etatotalm, hrtotalm, ktotalm, tkm_rhocptotalm, etafluidcur_inv_kphim, hrsolidm, hrfluidm, phim)\n\n\nDetails\n\n- m: marker number\n- tm: type of markers\n- tkm: temperature of markers\n- rhototalm: total density of markers\n- rhocptotalm: total volumetric heat capacity of markers\n- etasolidcur: solid viscosity of markers\n- etafluidcur: fluid viscosity of markers\n- etatotalm: total viscosity of markers\n- hrtotalm: total radiogenic heat production of markers\n- ktotalm: total thermal conductivity of markers\n- tkm_rhocptotalm: total thermal energy of markers\n- etafluidcur_inv_kphim: (fluid viscosity)/permeability of markers\n- hrsolidm: vector of radiogenic heat production of solid materials\n- hrfluidm: vector of radiogenic heat production of fluid materials\n- phim: porosity of markers\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.compute_nodal_adjustment!-NTuple{17, Any}","page":"Home","title":"HydrologyPlanetesimals.compute_nodal_adjustment!","text":"Compute nodal adjustment and return plastic iterations completeness status.\n\ncompute_nodal_adjustment!(ETA, ETA0, ETA5, GGG, SXX, SXY, pr, pf, COH, TEN, FRI, YNY, YNY5, YERRNOD, DSY, dt, iplast)\n\n\nDetails\n\n- ETA: viscoplastic viscosity at basic nodes\n- ETA0: previous time step viscoplastic viscosity at basic nodes\n- ETA5: plastic iterations viscoplastic viscosity at basic nodes\n- GGG: shear modulus at basic nodes\n- SXX: σ′xx at P nodes\n- SXY: σxy at basic nodes\n- pr: total pressure at P nodes\n- pf: fluid pressure at P nodes\n- COH: compressive strength at basic nodes \n- TEN: tensile strength at basic nodes \n- FRI: friction at basic nodes\n- YNY: plastic yielding status at basic nodes \n- YNY5: plastic iterations plastic yielding status at basic nodes\n- YERRNOD: vector of summed yielding errors of nodes over plastic iterations\n- DSY: (SIIB-syield) at basic nodes\n- dt: time set\n- iplast: plastic iteration step\n\nReturns\n\n- plastic_iterations_complete: true if plastic iterations complete\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.compute_p_node_properties!-NTuple{20, Any}","page":"Home","title":"HydrologyPlanetesimals.compute_p_node_properties!","text":"Compute properties of P nodes based on interpolation arrays.\n\ncompute_p_node_properties!(RHOSUM, RHOCPSUM, ALPHASUM, ALPHAFSUM, HRSUM, GGGPSUM, SXXSUM, TKSUM, PHISUM, WTPSUM, RHO, RHOCP, ALPHA, ALPHAF, HR, GGGP, SXX0, tk1, PHI, BETTAPHI)\n\n\nDetails\n\n- GGGPSUM: GGGP interpolation array\n- SXX0SUM: SXX0 interpolation array\n- RHOSUM: RHO interpolation array\n- RHOCPSUM: RHOCP interpolation array\n- ALPHASUM: ALPHA interpolation array\n- ALPHAFSUM: ALPHAF interpolation array\n- HRSUM: HR interpolation array\n- PHISUM: PHI interpolation array\n- TKSUM: TK interpolation array\n- WTPSUM: WTP interpolation array\n- GGGP: GGGP P node array\n- SXX0: SXX0 P node array\n- RHO: RHO P node array\n- RHOCP: RHOCP P node array\n- ALPHA: ALPHA P node array\n- ALPHAF: ALPHAF P node array\n- HR: HR P node array\n- PHI: PHI P node array\n- BETTAPHI: BETTAPHI P node array\n- tk1: tk1 P node array\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.compute_rotation_rate!-Tuple{Any, Any, Any}","page":"Home","title":"HydrologyPlanetesimals.compute_rotation_rate!","text":"Compute rotatation rate in basic nodes based on velocity derivatives at Vx and Vy nodes.\n\ncompute_rotation_rate!(vx, vy, wyx)\n\n\nDetails\n\n- vx: solid vx-velocity at Vx nodes\n- vy: solid vy-velocity at Vy nodes\n- wyx: rotation rate at basic nodes\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.compute_shear_heating!-NTuple{13, Any}","page":"Home","title":"HydrologyPlanetesimals.compute_shear_heating!","text":"Compute shear heating based on basic (temperature) and P grids.\n\ncompute_shear_heating!(HS, ETA, SXY, ETAP, SXX, RX, RY, qxD, qyD, PHI, ETAPHI, pr, pf)\n\n\nDetails\n\n- HS: shear heating\n- ETA: viscoplastic viscosity at basic nodes\n- SXY: σ₀xy XY stress at basic nodes\n- ETAP: viscosity at P nodes\n- SXX: σ₀xy XY stress at basic nodes\n- RX: ηfluid/Kϕ at Vx nodes\n- RY: ηfluid/Kϕ at Vy nodes\n- qxD: qx-Darcy flux at Vx nodes\n- qyD: qy-Darcy flux at Vy nodes\n- PHI: porosity at P nodes\n- ETAPHI: bulk viscosity at P nodes\n- pr: total pressure at P nodes\n- pf: fluid pressure at P nodes\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.compute_stress_strainrate!-NTuple{17, Any}","page":"Home","title":"HydrologyPlanetesimals.compute_stress_strainrate!","text":"Compute stress, stress change, and strain rate components.\n\ncompute_stress_strainrate!(vx, vy, ETA, GGG, ETAP, GGGP, SXX0, SXY0, EXX, EXY, SXX, SXY, DSXX, DSXY, EII, SII, dtm)\n\n\nDetails\n\nIn\n\n- vx: solid vx velocity at Vx nodes\n- vy: solid vy velocity at Vy nodes\n- ETA: viscosity at basic nodes\n- GGG: shear modulus at basic nodes\n- ETAP: viscosity at P nodes\n- GGGP: shear modulus at P nodes\n- SXX0: previous time step σ₀′xx at P nodes\n- SXY0: previous time step σ₀xy at basic nodes\n- dtm: displacement time step\n\nOut\n\n- EXX: ϵxx at P nodes\n- EXY: ϵxy at basic nodes\n- SXX: σ′xx P nodes\n- SXY: σxy at basic nodes\n- DSXX: stress change Δσ′xx at P nodes\n- DSXY: stress change Δσxy at basic nodes\n- EII: second strain rate invariant ϵᴵᴵ at P nodes\n- SII: second stress invariant σᴵᴵ at P nodes\n\nReturns\n\n    - nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.compute_velocities!-NTuple{8, Any}","page":"Home","title":"HydrologyPlanetesimals.compute_velocities!","text":"Compute solid velocities, fluid velocities at P nodes.\n\ncompute_velocities!(vx, vy, vxf, vyf, vxp, vyp, vxpf, vypf)\n\n\nDetails\n\n- vx: solid vx-velocity at Vx nodes\n- vy: solid vy-velocity at Vy nodes\n- vxf: fluid vx-velocity at Vx nodes\n- vyf: fluid vy-velocity at Vy nodes\n- vxp: solid vx-velocity at P nodes\n- vyp: solid vy-velocity at P nodes\n- vxpf: fluid vx-velocity at P nodes\n- vypf: fluid vy-velocity at P nodes\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.compute_vx_node_properties!-NTuple{11, Any}","page":"Home","title":"HydrologyPlanetesimals.compute_vx_node_properties!","text":"Compute properties of Vx nodes based on interpolation arrays.\n\ncompute_vx_node_properties!(RHOXSUM, RHOFXSUM, KXSUM, PHIXSUM, RXSUM, WTXSUM, RHOX, RHOFX, KX, PHIX, RX)\n\n\nDetails\n\n- RHOXSUM: RHOX interpolation array\n- RHOFXSUM: RHOFX interpolation array\n- KXSUM: KX interpolation array\n- PHIXSUM: PHIX interpolation array\n- RXSUM: RX interpolation array\n- WTXSUM: WTX interpolation array\n- RHOX: RHOX Vx node array\n- RHOFX: RHOFX Vx node array\n- KX: KX Vx node array\n- PHIX: PHIX Vx node array\n- RX: RX Vx node array\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.compute_vy_node_properties!-NTuple{11, Any}","page":"Home","title":"HydrologyPlanetesimals.compute_vy_node_properties!","text":"Compute properties of Vy nodes based on interpolation arrays.\n\ncompute_vy_node_properties!(RHOYSUM, RHOFYSUM, KYSUM, PHIYSUM, RYSUM, WTYSUM, RHOY, RHOFY, KY, PHIY, RY)\n\n\nDetails\n\n- RHOYSUM: RHOY interpolation array\n- RHOFYSUM: RHOFY interpolation array\n- KYSUM: KY interpolation array\n- PHIYSUM: PHIY interpolation array\n- RYSUM: RY interpolation array\n- WTYSUM: WTY interpolation array\n- RHOY: RHOY Vy node array\n- RHOFY: RHOFY Vy node array\n- KY: KY Vy node array\n- PHIY: PHIY Vy node array\n- RY: RY Vy node array\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.define_markers!-NTuple{19, Any}","page":"Home","title":"HydrologyPlanetesimals.define_markers!","text":"Define initial set of markers according to model parameters\n\ndefine_markers!(xm, ym, tm, phim, etavpm, rhototalm, rhocptotalm, etatotalm, hrtotalm, ktotalm, etafluidcur, tkm, inv_gggtotalm, fricttotalm, cohestotalm, tenstotalm, rhofluidcur, alphasolidcur, alphafluidcur; randomized)\n\n\nDetails\n\n- xm: x coordinates of markers\n- ym: y coordinates of markers\n- tm: material type of markers\n- phim: porosity of markers\n- etavpm: matrix viscosity of markers\n- rhototalm: total density of markers\n- rhocptotalm: total volumetric heat capacity of markers\n- etatotalm: total viscosity of markers\n- hrtotalm: total radiogenic heat production of markers\n- ktotalm: total thermal conductivity of markers\n- etafluidcur: fluid viscosity of markers\n- tkm: temperature of markers \n- inv_gggtotalm: inverse of total shear modulus of markers\n- fricttotalm: total friction coefficient of markers\n- cohestotalm: total compressive strength of markers\n- tenstotalm: total tensile strength of markers\n- rhofluidcur: fluid density of markers\n- alphasolidcur: solid thermal expansion coefficient of markers\n- alphafluidcur: fluid thermal expansion coefficient of markers\n- randomized: uniformly random-distribute marker x/y positions within cells\n              and randomly set initial marker porosity\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.distance-NTuple{4, Any}","page":"Home","title":"HydrologyPlanetesimals.distance","text":"Calculate Euclidean distance between two point coordinates.\n\ndistance(x1, y1, x2, y2)\n\n\nDetails\n\n- x1: x-coordinate of point 1 [m]\n- y1: y-coordinate of point 1 [m]\n- x2: x-coordinate of point 2 [m]\n- y2: y-coordinate of point 2 [m]\n\nReturns\n\n- Euclidean distance between point 1 and point 2 [m]\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.etatotal_rocks-Tuple{Any, Any}","page":"Home","title":"HydrologyPlanetesimals.etatotal_rocks","text":"Compute total rocky marker viscosity based on temperature and material type.\n\netatotal_rocks(tkmm, tmm)\n\n\nDetails\n\n- tkmm: marker temperature [K]\n- tmm: marker type [1, 2]\n\nReturns\n\n- etatotal: rocky marker temperature-dependent total viscosity\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.finalize_plastic_iteration_pass!-NTuple{9, Any}","page":"Home","title":"HydrologyPlanetesimals.finalize_plastic_iteration_pass!","text":"Decide next pass plastic iteration time step, viscoplastic viscosity, and basic node yielding status.\n\nfinalize_plastic_iteration_pass!(ETA, ETA5, ETA00, YNY, YNY5, YNY00, YNY_inv_ETA, dt, iplast)\n\n\nDetails:\n\n- ETA: viscoplastic viscosity at basic nodes\n- ETA5: plastic iterations viscoplastic viscosity at basic nodes\n- ETA00: previous time step viscoplastic viscosity at basic nodes\n- YNY: plastic yielding status at basic nodes \n- YNY5: plastic iterations plastic yielding status at basic nodes\n- YNY00: previous time step plastic yielding status at basic nodes\n- YNY_inv_ETA: inverse of plastic viscosity at yielding basic nodes\n- dt: current time step\n- iplast: current plastic iteration counter\n\nReturns\n\n- dt: adjusted next time step\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.fix-NTuple{10, Any}","page":"Home","title":"HydrologyPlanetesimals.fix","text":"Compute top and left grid nodes indices (i, j) and x- and y-distances to that  grid node (i, j) for given (x, y) position and grid axes.\n\nfix(x, y, x_axis, y_axis, dx, dy, jmin, jmax, imin, imax)\n\n\nDetails\n\n- x: x-position [m]\n- y: y-position [m]\n- x_axis: x-grid reference axis array [m]\n- y_axis: y-grid reference axis array [m]\n- dx: x-grid axis mesh width [m]\n- dy: y-grid axis mesh width [m]\n- jmin: minimum assignable index on x-grid axis (basic/Vx/Vy/P)\n- jmax: maximum assignable index on x-grid axis (basic/Vx/Vy/P)\n- imin: minimum assignable index on y-grid axis (basic/Vx/Vy/P)\n- imax: maximum assignable index on y-grid axis (basic/Vx/Vy/P)\n\nReturns\n\n- i: top (with reference to y) node index on y-grid axis\n- j: left (with reference to x) node index on x-grid axis\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.fix_distances-NTuple{10, Any}","page":"Home","title":"HydrologyPlanetesimals.fix_distances","text":"Compute top and left grid nodes indices (i, j) and x- and y-distances to that  grid node (i, j) for given (x, y) position and grid axes.\n\nfix_distances(x, y, x_axis, y_axis, dx, dy, jmin, jmax, imin, imax)\n\n\nDetails\n\n- x: x-position [m]\n- y: y-position [m]\n- x_axis: x-grid reference axis array [m]\n- y_axis: y-grid reference axis array [m]\n- dx: x-grid axis mesh width [m]\n- dy: y-grid axis mesh width [m]\n- jmin: minimum assignable index on x-grid axis (basic/Vx/Vy/P)\n- jmax: maximum assignable index on x-grid axis (basic/Vx/Vy/P)\n- imin: minimum assignable index on y-grid axis (basic/Vx/Vy/P)\n- imax: maximum assignable index on y-grid axis (basic/Vx/Vy/P)\n\nReturns\n\n- i: top (with reference to y) node index on y-grid axis\n- j: left (with reference to x) node index on x-grid axis\n- dxmj: x-distance from (x, y) point to (i, j) node\n- dymi: y-distance from (x, y) point to (i, j) node\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.fix_weights-NTuple{10, Any}","page":"Home","title":"HydrologyPlanetesimals.fix_weights","text":"Compute top and left grid nodes indices and bilinear interpolation weigths to nearest four grid nodes for given (x, y) position and grid axes.\n\nfix_weights(x, y, x_axis, y_axis, dx, dy, jmin, jmax, imin, imax)\n\n\nDetails\n\n- x: x-position [m]\n- y: y-position [m]\n- x_axis: x-grid reference axis array [m]\n- y_axis: y-grid reference axis array [m]\n- dx: x-grid axis mesh width [m]\n- dy: y-grid axis mesh width [m]\n- jmin: minimum assignable index on x-grid axis (basic/Vx/Vy/P)\n- jmax: maximum assignable index on x-grid axis (basic/Vx/Vy/P)\n- imin: minimum assignable index on y-grid axis (basic/Vx/Vy/P)\n- imax: maximum assignable index on y-grid axis (basic/Vx/Vy/P)\n\nReturns\n\n- i: top (with reference to y) node index on y-grid axis\n- j: left (with reference to x) node index on x-grid axis\n- bilinear_weights: vector of 4 bilinear interpolation weights to\n  nearest four grid nodes:\n    [wtmij  : i  , j   node,\n    wtmi1j : i+1, j   node,\n    wtmij1 : i  , j+1 node,\n    wtmi1j1: i+1, j+1 node]\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.get_viscosities_stresses_density_gradients!-NTuple{18, Any}","page":"Home","title":"HydrologyPlanetesimals.get_viscosities_stresses_density_gradients!","text":"Compute viscosities, stresses, and density gradients for hydromechanical solver.\n\nget_viscosities_stresses_density_gradients!(ETA, ETAP, GGG, GGGP, SXY0, SXX0, RHOX, RHOY, dt, ETAcomp, ETAPcomp, SXYcomp, SXXcomp, SYYcomp, dRHOXdx, dRHOXdy, dRHOYdx, dRHOYdy)\n\n\nDetails\n\nIn\n\n- ETA: viscoplastic viscosity at basic nodes\n- ETAP: viscosity at P nodes\n- GGG: shear modulus at basic nodes\n- GGGP: shear modulus at P nodes\n- SXY0: σ₀xy XY stress at basic nodes\n- SXX0:σ₀xy XY stress at basic nodes\n- RHOX: density at Vx nodes\n- RHOY: density at Vy nodes\n- dt: time step\n\nOut\n\n- ETAcomp: computational viscosity at basic nodes\n- ETAPcomp: computational viscosity at P nodes\n- SXYcomp: previous XY stresses at basic nodes\n- SXXcomp: previous XX stresses at P nodes\n- SYYcomp: previous YY stresses at P nodes\n- dRHOXdx: density gradient at Vx nodes in x direction\n- dRHOXdy: density gradient at Vx nodes in y direction\n- dRHOYdx: density gradient at Vy nodes in x direction\n- dRHOYdy: density gradient at Vy nodes in y direction\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.grid_average-Tuple{Any, Any, Any}","page":"Home","title":"HydrologyPlanetesimals.grid_average","text":"Get the arithmetic average of values from a grid 4-stencil anchored at (i, j).\n\ngrid_average(i, j, grid)\n\n\nDetails\n\n- i: top left grid node column index\n- j: top left grid node row index\n- grid: data from which to get the average value\n\nReturns\n\n- grid_average: (grid[i, j]+grid[i+1, j]+grid[i, j+1]+grid[i+1, j+1]) / 4\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.grid_vector-Tuple{Any, Any, Any}","page":"Home","title":"HydrologyPlanetesimals.grid_vector","text":"Get a 4-vector of values from a grid 4-stencil anchored at (i, j) in  column-major order.\n\ngrid_vector(i, j, grid)\n\n\nDetails\n\n- i: top left grid node column index\n- j: top left grid node row index\n- grid: data from which to build Vector\n\nReturns\n\n- grid_vector: 4-vector of values\n    [grid[i, j], grid[i+1, j], grid[i, j+1], grid[i+1, j+1]]\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.interpolate_add_to_grid!-NTuple{5, Any}","page":"Home","title":"HydrologyPlanetesimals.interpolate_add_to_grid!","text":"Interpolate a property to neareast four nodes on a given grid location using given bilinear interpolation weights.\n\nDetails\n\n- i: top (with reference to y) node index on vertical y-grid axis\n- j: left (with reference to x) node index on horizontal x-grid axis\n- weights: vector of 4 bilinear interpolation weights to\n  nearest four grid nodes:\n    [wtmij  : i  , j   node,\n    wtmi1j : i+1, j   node,\n    wtmij1 : i  , j+1 node,\n    wtmi1j1: i+1, j+1 node]\n- property: property to be interpolated to grid using weights\n- grid: threaded grid array on which to interpolate property\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.interpolate_add_to_marker!-NTuple{6, Any}","page":"Home","title":"HydrologyPlanetesimals.interpolate_add_to_marker!","text":"Interpolate a property from nearest the four nodes on a given grid to a marker and add it to the markers property.\n\nDetails\n\n- m: number of marker to interpolate to\n- i: top (with reference to y) node index on vertical y-grid axis\n- j: left (with reference to x) node index on horizontal x-grid axis\n- weights: vector of 4 bilinear interpolation weights to\nnearest four grid nodes:\n    [wtmij  : i  , j   node,\n    wtmi1j : i+1, j   node,\n    wtmij1 : i  , j+1 node,\n    wtmi1j1: i+1, j+1 node]\n- marker_property: marker property array into which to interpolate and add\n- property_grid: grid whose property is to be interpolated to marker\n- m: marker\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.interpolate_to_marker!-NTuple{6, Any}","page":"Home","title":"HydrologyPlanetesimals.interpolate_to_marker!","text":"Interpolate a property from nearest the four nodes on a given grid to a marker.\n\nDetails\n\n- m: number of marker to interpolate to\n- i: top (with reference to y) node index on vertical y-grid axis\n- j: left (with reference to x) node index on horizontal x-grid axis\n- weights: vector of 4 bilinear interpolation weights to\nnearest four grid nodes:\n    [wtmij  : i  , j   node,\n    wtmi1j : i+1, j   node,\n    wtmij1 : i  , j+1 node,\n    wtmi1j1: i+1, j+1 node]\n- marker_property: marker property array into which to interpolate\n- property_grid: grid whose property is to be interpolated to marker\n- m: marker\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.kphi-Tuple{Any, Any, Any}","page":"Home","title":"HydrologyPlanetesimals.kphi","text":"Compute iron porosity-dependent permeability.\n\nkphi(kphim0, phim, phim0)\n\n\nDetails\n\n- kphim0: standard permeability [m^2]\n- phim: actual (marker) porosity\n- phim0: standard iron fraction (porosity)\n\nReturns\n\n- kphim: iron porosity-dependent permeability [m^2]\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.ktotal-Tuple{Any, Any, Any}","page":"Home","title":"HydrologyPlanetesimals.ktotal","text":"Compute total thermal conductivity of two-phase material.\n\nktotal(ksolid, kfluid, phi)\n\n\nDetails\n\n- ksolid: solid thermal conductivity [W/m/K]\n- kfluid: fluid thermal conductivity [W/m/K]\n- phi: fraction of solid\n\nReturns\n\n- ktotal: total thermal conductivity of mixed phase [W/m/K]\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.marker_to_basic_nodes!-NTuple{18, Any}","page":"Home","title":"HydrologyPlanetesimals.marker_to_basic_nodes!","text":"Interpolate selected marker properties to basic nodes.\n\nmarker_to_basic_nodes!(m, xmm, ymm, etatotalm, etavpm, inv_gggtotalm, sxym, cohestotalm, tenstotalm, fricttotalm, ETA0SUM, ETASUM, GGGSUM, SXYSUM, COHSUM, TENSUM, FRISUM, WTSUM)\n\n\nDetails\n\n- m: marker number\n- xmm: marker's x-position [m]\n- ymm: marker's y-position [m]\n- etatotalm: total viscosity of markers\n- etavpm: matrix viscosity of markers\n- inv_gggtotalm: inverse of total shear modulus of markers\n- sxym: marker σxy [Pa]\n- cohestotalm: total compressive strength of markers\n- tenstotalm: total tensile strength of markers \n- fricttotalm: total friction coefficient of markers\n- ETA0SUM: viscous viscosity interpolated to basic nodes\n- ETASUM: viscoplastic viscosity interpolated to basic nodes\n- GGGSUM: shear modulus interpolated to basic nodes\n- SXYSUM: σxy shear stress interpolated to basic nodes \n- COHSUM: compressive strength interpolated to basic nodes\n- TENSUM: tensile strength interpolated to basic nodes\n- FRISUM: friction interpolated to basic nodes \n- WTSUM: weight array for bilinear interpolation to basic nodes\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.marker_to_p_nodes!-NTuple{22, Any}","page":"Home","title":"HydrologyPlanetesimals.marker_to_p_nodes!","text":"Interpolate selected marker properties to P nodes.\n\nmarker_to_p_nodes!(m, xmm, ymm, inv_gggtotalm, sxxm, rhototalm, rhocptotalm, alphasolidcur, alphafluidcur, hrtotalm, phim, tkm_rhocptotalm, GGGPSUM, SXXSUM, RHOSUM, RHOCPSUM, ALPHASUM, ALPHAFSUM, HRSUM, PHISUM, TKSUM, WTPSUM)\n\n\nDetails\n\n- m: marker number\n- xmm: marker x-position [m]\n- ymm: marker y-position [m]\n- inv_gggtotalm: inverse of total shear modulus of markers\n- sxxm: marker σ′xx [Pa]\n- rhototalm: total density of markers\n- rhocptotalm: total volumetric heat capacity of markers \n- alphasolidcur: solid thermal expansion coefficient of markers \n- alphafluidcur: fluid thermal expansion coefficient of markers\n- hrtotalm: total radiogenic heat production of markers\n- phim:  marker porosity\n- tkm_rhocptotalm: total thermal energy of markers\n- GGGPSUM: shear modulus interpolated to P nodes\n- SXXSUM: σ'xx interpolated to P nodes\n- RHOSUM: density interpolated to P nodes\n- RHOCPSUM: volumetric heat capacity interpolated to P nodes\n- ALPHASUM: thermal expansion interpolated to P nodes\n- ALPHAFSUM: fluid thermal expansion interpolated to P nodes\n- HRSUM: radioactive heating interpolated to P nodes\n- PHISUM: porosity interpolated to P nodes\n- TKSUM: heat capacity interpolated to P nodes\n- WTPSUM: weight for bilinear interpolation to P nodes\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.marker_to_vx_nodes!-NTuple{14, Any}","page":"Home","title":"HydrologyPlanetesimals.marker_to_vx_nodes!","text":"Interpolate selected marker properties to Vx nodes.\n\nmarker_to_vx_nodes!(m, xmm, ymm, rhototalm, rhofluidcur, ktotalm, phim, etafluidcur_inv_kphim, RHOXSUM, RHOFXSUM, KXSUM, PHIXSUM, RXSUM, WTXSUM)\n\n\nDetails\n\n- m: marker number\n- xmm: marker's x-position [m]\n- ymm: marker's y-position [m]\n- rhototalm: total density of markers\n- rhofluidcur: fluid density of markers\n- ktotalm: total thermal conductivity of markers\n- phim: porosity of markers\n- etafluidcur_inv_kphim: fluid viscosity over permeability of markers\n- RHOXSUM: density interpolated to Vx nodes\n- RHOFXSUM: fluid density interpolated to Vx nodes\n- KXSUM: thermal conductivity interpolated to Vx nodes\n- PHIXSUM: porosity interpolated to Vx nodes\n- RXSUM: ηfluid/kϕ interpolated to Vx nodes\n- WTXSUM: weight for bilinear interpolation to Vx nodes\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.marker_to_vy_nodes!-NTuple{14, Any}","page":"Home","title":"HydrologyPlanetesimals.marker_to_vy_nodes!","text":"Interpolate selected marker properties to Vy nodes.\n\nmarker_to_vy_nodes!(m, xmm, ymm, rhototalm, rhofluidcur, ktotalm, phim, etafluidcur_inv_kphim, RHOYSUM, RHOFYSUM, KYSUM, PHIYSUM, RYSUM, WTYSUM)\n\n\nDetails\n\n- m: marker number\n- xmm: marker's x-position [m]\n- ymm: marker's y-position [m]\n- rhototalm: total density of markers\n- rhofluidcur: fluid density of markers\n- ktotalm: total thermal conductivity of markers\n- phim: porosity of markers\n- etafluidcur_inv_kphim: fluid viscosity over permeability of markers\n- RHOYSUM: density interpolated to Vy nodes\n- RHOFYSUM: fluid density interpolated to Vy nodes\n- KYSUM: thermal conductivity interpolated to Vy nodes\n- PHIYSUM: porosity interpolated to Vy nodes\n- RYSUM: ηfluid/kϕ interpolated to Vy nodes\n- WTYSUM: weight for bilinear interpolation to Vy nodes\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.move_markers_rk4!-NTuple{15, Any}","page":"Home","title":"HydrologyPlanetesimals.move_markers_rk4!","text":"Move markers using classic Runge-Kutta integration (RK4) taking into account two-phase flow and solid-fluid temperatures.\n\nmove_markers_rk4!(xm, ym, tm, tkm, phim, sxym, sxxm, vx, vy, vxf, vyf, wyx, tk2, marknum, dtm)\n\n\nDetails\n\n- xm: x-coordinate of markers\n- ym: y-coordinate of markers\n- tm: type of markers \n- tkm: temperature of markers\n- phim: porosity of markers  \n- sxxm: marker σ′xx\n- sxym: marker σxy\n- vx: solid vx-velocity at Vx nodes\n- vy: solid vy-velocity at Vy nodes\n- vxf: fluid vx-velocity at Vx nodes\n- vyf: fluid vy-velocity at Vy nodes\n- wyx: rotation rate at basic nodes\n- tk2: next temperature at P nodes\n- marknum: number of markers in use\n- dtm: displacement time step\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.parse_commandline-Tuple{}","page":"Home","title":"HydrologyPlanetesimals.parse_commandline","text":"Parse command line arguments and feed them to the main function.\n\nparse_commandline()\n\n\nDetails:\n\n- nothing\n\nReturns\n\n- parsed_args: parsed command line arguments\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.perform_thermal_iterations!-NTuple{14, Any}","page":"Home","title":"HydrologyPlanetesimals.perform_thermal_iterations!","text":"Perform thermal iterations to time step thermal field at P nodes.\n\nperform_thermal_iterations!(tk0, tk1, tk2, DT, DT0, RHOCP, KX, KY, HR, HA, HS, RT, ST, dtm)\n\n\nDetails\n\n- tk0: previous temperature at P nodes \n- tk1: current temperature at P nodes\n- tk2: next temperature at P nodes \n- DT: calculated temperature difference at P nodes \n- DT0: previous calculated temperature difference at P nodes\n- RHOCP: volumetric heat capacity at P nodes  \n- KX: thermal conductivity at Vx nodes\n- KY: thermal conductivity at Vy nodes \n- HR: radioactive heating at P nodes\n- HA: adiabatic heating at P nodes \n- HS: shear heating at P nodes\n- RT: thermal RHS coefficient vector\n- ST: thermal solution vector\n- dtm: displacement time step\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.positive_max!-Tuple{Any, Any, Any}","page":"Home","title":"HydrologyPlanetesimals.positive_max!","text":"Compare two arrays of identical sizes element-wise and fill a third array with the larger value if positive and zero otherwise.\n\npositive_max!(A, B, C)\n\n\nDetails\n\n- A: first array\n- B: second array\n- C: result array\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.process_hydromechanical_solution!-NTuple{7, Any}","page":"Home","title":"HydrologyPlanetesimals.process_hydromechanical_solution!","text":"Process hydromechanical solution vector to output physical observables.\n\nprocess_hydromechanical_solution!(S, vx, vy, pr, qxD, qyD, pf)\n\n\nDetails\n\n- S: hydromechanical solution vector\n- vx: solid velocity at Vx nodes\n- vy: solid velocity at Vy nodes\n- pr: total pressure at P nodes\n- qxD: qx-Darcy flux at Vx nodes\n- qyD: qy-Darcy flux at Vy nodes\n- pf: fluid pressure at P nodes\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.recompute_bulk_viscosity!-NTuple{5, Any}","page":"Home","title":"HydrologyPlanetesimals.recompute_bulk_viscosity!","text":"Recompute bulk viscosity at P nodes.\n\nDetails\n\n- ETA: viscoplastic viscosity at basic nodes\n- ETAP: viscosity at P nodes\n- ETAPHI: bulk viscosity at P nodes\n- PHI: porosity at P nodes\n- etaphikoef: coefficient: shear viscosity -> compaction viscosity\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.reduce_add_3darray!-Tuple{Any}","page":"Home","title":"HydrologyPlanetesimals.reduce_add_3darray!","text":"Reduce a 3D (i, j, k) along its third (k) axis by addition and write the result into (i, j, 1) without reallocating the array's memory.\n\nreduce_add_3darray!(A)\n\n\nDetails\n\n- A: 3D array [i, j, k]\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.replenish_markers!-NTuple{10, Any}","page":"Home","title":"HydrologyPlanetesimals.replenish_markers!","text":"Add markers to populate currently sparsely filled grid areas.\n\nreplenish_markers!(xm, ym, tm, tkm, phim, sxxm, sxym, etavpm, mdis, mnum; randomized)\n\n\nDetails\n\n- xm: horizontal x-position of markers\n- ym: vertical y-position of markers\n- tm: type of markers\n- tkm: temperature of markers \n- phim: porosity of markers \n- sxxm: marker σ′xx of markers\n- sxym: σxy of markers\n- etavpm: viscoplastic viscosity  \n- mdis: minimum distance of marker launch anchor points to nearest marker \n- mnum: number of marker nearest to marker launch anchor positions\n\nReturns\n\n- marknum: updated number of markers in use\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.run_simulation-Tuple{}","page":"Home","title":"HydrologyPlanetesimals.run_simulation","text":"Runs the simulation with the given parameters.\n\nrun_simulation()\n\n\nDetails\n\n- show_timer: show the measured times spent in respective sections\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.save_state-NTuple{106, Any}","page":"Home","title":"HydrologyPlanetesimals.save_state","text":"Save simulation state to JLD2 output file named after current timestep.\n\nsave_state(output_path, timestep, dt, dtm, timesum, marknum, ETA, ETA0, GGG, EXY, SXY, SXY0, wyx, COH, TEN, FRI, YNY, RHOX, RHOFX, KX, PHIX, vx, vxf, RX, qxD, gx, RHOY, RHOFY, KY, PHIY, vy, vyf, RY, qyD, gy, RHO, RHOCP, ALPHA, ALPHAF, HR, HA, HS, ETAP, GGGP, EXX, SXX, SXX0, tk1, tk2, vxp, vyp, vxpf, vypf, pr, pf, ps, pr0, pf0, ps0, ETAPHI, BETTAPHI, PHI, APHI, FI, ETA5, ETA00, YNY5, YNY00, YNY_inv_ETA, DSXY, ETAcomp, SXYcomp, dRHOXdx, dRHOXdy, dRHOYdx, dRHOYdy, ETAPcomp, SXXcomp, SYYcomp, EII, SII, DSXX, xm, ym, tm, tkm, sxxm, sxym, etavpm, phim, rhototalm, rhocptotalm, etasolidcur, etafluidcur, etatotalm, hrtotalm, ktotalm, tkm_rhocptotalm, etafluidcur_inv_kphim, inv_gggtotalm, fricttotalm, cohestotalm, tenstotalm, rhofluidcur, alphasolidcur, alphafluidcur)\n\n\nDetails\n\n- output_path: absolute path to output directory\n- timestep: current time step number\n- dt: time step\n- dtm: displacement time step \n- timesum: total simulation time\n- marknum: number of markers\n- ETA... : simulation state variables\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.setup_dynamic_simulation_parameters-Tuple{}","page":"Home","title":"HydrologyPlanetesimals.setup_dynamic_simulation_parameters","text":"Set up and initialize dynamic simulation parameters.\n\nsetup_dynamic_simulation_parameters()\n\n\nDetails\n\n- nothgin\n\nReturns\n\n- timestep: simulation starting time step count\n- dt: simulation initial computational time step [s]\n- timesum: simulation starting time [s]\n- marknum: initial number of markers\n- hrsolidm: initial radiogenic heat production solid phase\n- hrfluidm: initial radiogenic heat production fluid phase\n- YERRNOD: vector of summed yielding errors of nodes over plastic iterations\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.setup_gravitational_lse-Tuple{}","page":"Home","title":"HydrologyPlanetesimals.setup_gravitational_lse","text":"Set up gravitational linear system of equations structures.\n\nsetup_gravitational_lse()\n\n\nDetails\n\n- nothing\n\nReturns\n\n- RP: gravitational linear system of equations: RHS vector\n- SP: gravitational linear system of equations: solution vector\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.setup_hydromechanical_lse-Tuple{}","page":"Home","title":"HydrologyPlanetesimals.setup_hydromechanical_lse","text":"Set up hydromechanical linear system of equations structures.\n\nsetup_hydromechanical_lse()\n\n\nDetails\n\n- nothing\n\nReturns\n\n- R: hydromechanical linear system of equations: RHS vector\n- S: hydromechanical linear system of equations: solution vector\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.setup_interpolated_properties-Tuple{}","page":"Home","title":"HydrologyPlanetesimals.setup_interpolated_properties","text":"Set up properties to be interpolated from markers to staggered grid.\n\nsetup_interpolated_properties()\n\n\nDetails\n\n- nothing\n\nReturns\n\n- ETA0SUM: interpolation of ETA0 at basic nodes\n- ETASUM: interpolation of ETA at basic nodes\n- GGGSUM: interpolation of GGG at basic nodes\n- SXYSUM: interpolation of SXY at basic nodes\n- COHSUM: interpolation of COH at basic nodes\n- TENSUM: interpolation of TEN at basic nodes\n- FRISUM: interpolation of FRI at basic nodes\n- WTSUM: interpolation weights at basic nodes\n- RHOXSUM: interpolation of RHOX at Vx nodes\n- RHOFXSUM: interpolation of RHOFX at Vx nodes\n- KXSUM: interpolation of KX at Vx nodes\n- PHIXSUM: interpolation of PHIX at Vx nodes\n- RXSUM: interpolation of RX at Vx nodes\n- WTXSUM: interpolation weights at Vx nodes\n- RHOYSUM: interpolation of RHOY at Vy nodes\n- RHOFYSUM: interpolation of RHOFY at Vy nodes\n- KYSUM: interpolation of KY at Vy nodes\n- PHIYSUM: interpolation of PHIX at Vy nodes\n- RYSUM: interpolation of RY at Vy nodes\n- WTYSUM: interpolation weights at Vy nodes\n- RHOSUM: interpolation of RHO at P nodes\n- RHOCPSUM: interpolation of RHOCP at P nodes\n- ALPHASUM: interpolation of ALPHA at P nodes\n- ALPHAFSUM: interpolation of ALPHAF at P nodes\n- HRSUM: interpolation of HR at P nodes\n- GGGPSUM: interpolation of GGGP at P nodes\n- SXXSUM: interpolation of SXX at P nodes\n- TKSUM: interpolation of TK at P nodes\n- PHISUM: interpolation of PHI at P nodes\n- WTPSUM: interpolation weights at P nodes\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.setup_marker_geometry_helpers-Tuple{}","page":"Home","title":"HydrologyPlanetesimals.setup_marker_geometry_helpers","text":"Set up additional marker geometry helpers to facilitate marker handling.\n\nsetup_marker_geometry_helpers()\n\n\nDetails\n\n- nothing\n\nReturns\n\n- mdis: minimum distance of marker launch anchor points to nearest marker\n- mnum: number of marker nearest to marker launch anchor positions\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.setup_marker_properties-Tuple{Any}","page":"Home","title":"HydrologyPlanetesimals.setup_marker_properties","text":"Set up geodesic and physical properties of the set of markers.\n\nsetup_marker_properties(marknum; randomized)\n\n\nDetails\n\n- randomized: fill in random values for grid properties instead of zeros\n\nReturns\n\n- xm : horizontal marker coordinate [m]\n- ym : vertical marker coordinate [m]\n- tm : marker material type\n- tkm : marker temperature [K]\n- sxxm : marker σ′xx [Pa]\n- sxym : marker σxy [Pa]\n- etavpm : marker viscoplastic viscosity [Pa]\n- phim : marker porosity\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.setup_marker_properties_helpers-Tuple{Any}","page":"Home","title":"HydrologyPlanetesimals.setup_marker_properties_helpers","text":"Set up additional helper marker properties to facility comptuations.\n\nsetup_marker_properties_helpers(marknum; randomized)\n\n\nDetails\n\n- randomized: fill in random values for grid properties instead of zeros\n\nReturns\n\n- rhototalm: total density of markers\n- rhocptotalm : total volumetric heat capacity of markers\n- etasolidcur: solid viscosity of markers\n- etafluidcur: fluid viscosity of markers\n- etatotalm: total viscosity of markers\n- hrtotalm: total radiogenic heat production of markers\n- ktotalm: total thermal conductivity of markers\n- tkm_rhocptotalm: total thermal energy of markers\n- etafluidcur_inv_kphim: fluid viscosity over permeability of markers\n- inv_gggtotalm: inverse of total shear modulus of markers\n- fricttotalm: total friction coefficient of markers\n- cohestotalm: total compressive strength of markers\n- tenstotalm: total tensile strength of markers\n- rhofluidcur: fluid density of markers\n- alphasolidcur: solid thermal expansion coefficient of markers\n- alphafluidcur: fluid thermal expansion coefficient of markers\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.setup_staggered_grid_properties-Tuple{}","page":"Home","title":"HydrologyPlanetesimals.setup_staggered_grid_properties","text":"Set up staggered grid properties for basic, Vx, Vy, and P nodes.\n\nsetup_staggered_grid_properties(; randomized)\n\n\nDetails\n\n- randomized: fill in random values for grid properties instead of zeros\n\nReturns\n\n- ETA : viscoplastic viscosity at basic nodes [Pa*s]\n- ETA0 : viscous viscosity at basic nodes [Pa*s]\n- GGG : shear modulus at basic nodes [Pa]\n- EXY : ϵxy at basic nodes [1/s]\n- SXY : σxy at basic nodes [1/s]\n- SXY0 : σ₀xy at basic nodes [1/s]\n- wyx : rotation rate at basic nodes [1/s]\n- COH : compressive strength at basic nodes [Pa]\n- TEN : tensile strength at basic nodes [Pa]\n- FRI : friction at basic nodes\n- YNY : plastic yielding node property at basic nodes\n- RHOX : density at Vx nodes [kg/m^3]\n- RHOFX : fluid density at Vx nodes [kg/m^3]\n- KX : thermal conductivity at Vx nodes [W/m/K]\n- PHIX : porosity at Vx nodes\n- vx : solid vx-velocity at Vx nodes [m/s]\n- vxf : fluid vx-velocity at Vx nodes [m/s]\n- RX : etafluid/kphi ratio at Vx nodes [m^2]\n- qxD : qx-darcy flux at Vx nodes [m/s]\n- gx : gx-gravity at Vx nodes [m/s^2]\n- RHOY : density at Vx nodes [kg/m^3]\n- RHOFY : fluid density at Vx nodes [kg/m^3]\n- KY : thermal conductivity at Vx nodes [W/m/K]\n- PHIY : porosity at Vx nodes\n- vy : solid vy-velocity at Vx nodes [m/s]\n- vyf : fluid vy-velocity at Vx nodes [m/s]\n- RY : etafluid/kphi ratio at Vx nodes [m^2]\n- qyD : qy-Darcy flux at Vx nodes [m/s]\n- gy : gy-gravity at Vx nodes [m/s^2]\n- RHO : density at P nodes [kg/m^3]\n- RHOCP : volumetric heat capacity at P nodes [J/m^3/K]\n- ALPHA : thermal expansion at P nodes [J/m^3/K]\n- ALPHAF : fluid thermal expansion at P nodes [J/m^3/K]\n- HR : radioactive heating at P nodes [W/m^3]\n- HA : adiabatic heating at P nodes [W/m^3]\n- HS : shear heating at P nodes [W/m^3]\n- ETAP : viscosity at P nodes [Pa*s]\n- GGGP : shear modulus at P nodes [Pa]\n- EXX : ϵxx at P nodes [1/s]\n- SXX : σ′xx at P nodes [1/s]\n- SXX0 : σ₀′xx at P nodes [1/s]\n- tk1 : current temperature at P nodes [K]\n- tk2 : next temperature at P nodes [K]\n- DT: temperature difference at P nodes [K]\n- DT0: previous temperature difference at P nodes [K]\n- vxp : solid vx in pressure nodes at P nodes [m/s]\n- vyp : solid vy in pressure nodes at P nodes [m/s]\n- vxpf : fluid vx in pressure nodes at P nodes [m/s]\n- vypf : fluid vy in pressure nodes at P nodes [m/s]\n- pr : total pressure at P nodes [Pa]\n- pf : fluid pressure at P nodes [Pa]\n- ps : solid pressure at P nodes [Pa]\n- pr0 : previous total pressure at P nodes [Pa]\n- pf0 : previous fluid pressure at P nodes [Pa]\n- ps0 : previous solid pressure at P nodes [Pa]\n- ETAPHI : bulk viscosity at P nodes [Pa*s]\n- BETTAPHI : bulk compresibility at P nodes [Pa*s]\n- PHI : porosity at P nodes\n- APHI : Dlnat P nodes [(1-ϕ)/ϕ]/Dt\n- FI : gravity potential at P nodes [J/kg]\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.setup_staggered_grid_properties_helpers-Tuple{}","page":"Home","title":"HydrologyPlanetesimals.setup_staggered_grid_properties_helpers","text":"Set up additional helper staggered grid properties to facilitate computations.\n\nsetup_staggered_grid_properties_helpers(; randomized)\n\n\nDetails\n\n- randomized: fill in random values for grid properties instead of zeros\n\nReturns\n\n- ETA5: plastic iterations viscoplastic viscosity at basic nodes [Pa⋅s]\n- ETA00: previous viscous viscosity at basic nodes [Pa⋅s]\n- YNY5: plastic iterations plastic yielding node property at basic nodes\n- YNY00: previous plastic yielding node property at basic nodes\n- DSXY: stress change Δσxy at basic nodes [Pa]\n- DSY: (SIIB-syield) at basic nodes\n- YNPL: plastic iterations plastic yielding status at basic nodes\n- DDD: plastic iterations (SIIB-syield)² at basic nodes\n- SIIB: second stress invariant at basic nodes\n- siiel: second invariant for purely elastic stress buildup at basic nodes\n- prB: interpolated total pressure at basic nodes \n- pfB: interpolated fluid pressure at basic nodes \n- syieldc: confined fractures yielding stress at basic nodes \n- syieldt: tensile fractures yielding stress at basic nodes \n- syield: non-negative maximum yielding stress at basic nodes\n- etapl: stress-based viscoplastic viscosity at basic nodes \n- ETAcomp: computational viscosity at basic nodes\n- SXYcomp: computational previous XY stress at basic nodes\n- dRHOXdx: total density gradient in x direction at Vx nodes\n- dRHOXdy: total density gradient in y direction at Vx nodes\n- dRHOYdx: total density gradient in x direction at Vy nodes\n- dRHOYdy: total density gradient in y direction at Vy nodes\n- ETAPcomp: computational viscosity at P nodes\n- SXXcomp: computational previous XX stress at P nodes\n- SYYcomp: computational previous YY stress at P nodes\n- EII :second strain rate invariant at P nodes [1/s]\n- SII :second stress invariant at P nodes [Pa]\n- DSXX :stress change Δσ′xx at P nodes [Pa]\n- tk0: previous temperature at P nodes [K]\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.setup_thermal_lse-Tuple{}","page":"Home","title":"HydrologyPlanetesimals.setup_thermal_lse","text":"Set up thermal linear system of equations structures.\n\nsetup_thermal_lse()\n\n\nDetails\n\n- nothing\n\nReturns\n\n- RT: thermal linear system of equations: RHS vector\n- ST: thermal linear system of equations: solution vector\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.simulation_loop-Tuple{Any}","page":"Home","title":"HydrologyPlanetesimals.simulation_loop","text":"Main simulation loop: run calculations with timestepping.\n\nsimulation_loop(output_path)\n\n\nDetails\n\n- output_path: Absolute path where to save simulation output files\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.symmetrize_p_node_observables!-NTuple{6, Any}","page":"Home","title":"HydrologyPlanetesimals.symmetrize_p_node_observables!","text":"Apply symmetry to P node observables.\n\nsymmetrize_p_node_observables!(SXX, APHI, PHI, pr, pf, ps)\n\n\nDetails\n\n- SXX: σ′xx at P nodes\n- APHI: Aϕ = Dln[(1-ϕ)/ϕ]/Dt at P nodes\n- PHI: porosity at P nodes\n- pr: total pressure at P nodes\n- pf: fluid pressure at P nodes\n- ps: solid pressure at P nodes\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.total-Tuple{Any, Any, Any}","page":"Home","title":"HydrologyPlanetesimals.total","text":"Compute convex combination of fluid and solid properties to get total property.\n\ntotal(solid, fluid, ϕ)\n\n\nDetails\n\n- fluid: fluid properties\n- solid: solid properties\n- ϕ: porosity (fraction of fluid)\n\nReturns\n\n- total: computed total property\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.update_marker_population_geometry!-NTuple{7, Any}","page":"Home","title":"HydrologyPlanetesimals.update_marker_population_geometry!","text":"Update marker population geometry status given a marker number and  nearest top/left marker grid point.\n\nupdate_marker_population_geometry!(m, i, j, xm, ym, mdis, mnum)\n\n\nDetails\n\n- m: marker number\n- i: vertical index of top/left marker grid point\n- j: horizontal index of top/left marker grid point\n- xm: horizontal x-position of markers\n- ym: vertical y-position of markers\n- mdis: minimum distance of marker launch anchor points to nearest marker\n- mnum: number of marker nearest to marker launch anchor positions\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.update_marker_porosity!-NTuple{7, Any}","page":"Home","title":"HydrologyPlanetesimals.update_marker_porosity!","text":"Update marker porosity based on Dln[(1-ϕ)/ϕ]/Dt at P grid.\n\nupdate_marker_porosity!(xm, ym, tm, phim, APHI, dtm, marknum)\n\n\nDetails\n\n- xm: x-coordinates of markers\n- ym: y-coordinates of markers\n- tm: marker type\n- phim: marker porosity\n- APHI: Dln[(1-ϕ)/ϕ]/Dt at P nodes\n- dtm: displacement time step\n- marknum: total number of markers in use\n\nReturns\n\n- nothing\n\n\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.update_marker_stress!-NTuple{7, Any}","page":"Home","title":"HydrologyPlanetesimals.update_marker_stress!","text":"Update marker stress based on xy (basic grid) and xx (P grid) stress changes.\n\nupdate_marker_stress!(xm, ym, sxxm, sxym, DSXX, DSXY, marknum)\n\n\nDetails\n\n- xm: x-coordinates of markers\n- ym: y-coordinates of markers\n- sxxm: marker σ′xx [Pa]\n- sxym: marker σxy [Pa]\n- DSXX: stress change Δσ′xx at P nodes\n- DSXY: stress change Δσxy at basic nodes\n- marknum: total number of markers in use\n\nReturns\n\n- nothing\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.update_marker_temperature!-NTuple{7, Any}","page":"Home","title":"HydrologyPlanetesimals.update_marker_temperature!","text":"Update marker temperature based on P grid temperature changes.\n\nupdate_marker_temperature!(xm, ym, tkm, DT, tk2, timestep, marknum)\n\n\nDetails\n\n- xm: x-coordinates of markers\n- ym: y-coordinates of markers\n- tkm: marker temperature\n- DT: temperature change at P nodes\n- tk2: next temperature at P nodes\n- timestep: current time step\n- marknum: total number of markers in use\n\nReturns\n\n- nothing\n\n\n\n\n\n\n\n","category":"method"},{"location":"#HydrologyPlanetesimals.update_marker_viscosity!-NTuple{9, Any}","page":"Home","title":"HydrologyPlanetesimals.update_marker_viscosity!","text":"Update marker viscoplastic viscosity based on basic node yielding status and marker temperature- and material-based viscosity.\n\nupdate_marker_viscosity!(m, xm, ym, tm, tkm, etatotalm, etavpm, YNY, YNY_inv_ETA)\n\n\nDetails\n\n- m: marker number\n- xm: x-coordinates of markers\n- ym: y-coordinates of markers\n- tm: type of markers\n- tkm: temperature of markers\n- etatotalm: total viscosity of markers\n- etavpm: matrix viscosity of markers\n- YNY: plastic yielding node property at basic nodes\n- YNY_inv_ETA: inverse viscoplastic viscosity at yielding basic nodes\n\nReturns\n\n-nothing\n\n\n\n\n\n","category":"method"}]
}
